<style media="screen">.menuCol{width:9.8%;}.appCol{width:90.2%;}</style>
<div class="container-fluid" style="min-height:100vh;background:#F5F6FA;padding-right:0px;">
  <div class="col-md-1" style="padding:0px;padding-top: 20px;">

    <button type="button" ng-click="commpose()" class="btn btn-default cutebutton" style="width:95%;margin-left:5px;border-radius:10px !important;" >Compose </button>

    <div ng-class="{active: folderSelected== f.name}" ng-repeat="f in folders track by $index" ng-click = "changeFolder(f.onServer)" style="margin-top:30px;" class="row">
      <span class="emailfolder" style="color:{{ folderSelected== f.name ? 'var(--headerNavbarHighlight);font-size:16px;':'black'}};padding-top:15px;padding-bottom:15px;cursor:pointer;" >
        <div align="center">{{f.name.split('.')[f.name.split('.').length-1]}}{{f.new | decorateCount}}</div>
      </span>
    </div>
  </div>
  <div class="col-md-4">
      <div class="row" style="padding: 15px;">
        <input type="text" class="form-control" placeholder="Search.." ng-model="textToSearch" ng-enter="search()" style="padding: 24px;border-radius: 10px;background: #EBECF2;border: none !important;margin-top: 4px;">
      </div>
      <!-- <div class="row emailListOptions" style="padding: 15px;">
        <div class="row">
          <div class="col-md-5" style="position: relative;top:12px;">
            <input  type="checkbox" name="name" ng-model = "selectAll">
            <span style="position: relative;top:-2px;left:5px;">Select all<span>
          </div>
          <div class="col-md-7" style="position: relative;top:10px;cursor:pointer;">
            <div class="btn-group pull-right">
              <span class="fa fa-angle-down fa-lg" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" ></span>
              <ul class="dropdown-menu">
                <li ng-click="deleteMail()"><a href="">Delete</a></li>
                <li ng-click="flagMails('addFlag')"><a href="">Star</a></li>
                <li ng-click="flagMails('removeFlag')"><a href="">Remove Star</a></li>
                <li><a>Move to</a></li>
                <li role="separator" class="divider"></li>
                <li ng-repeat="f in folders" ng-click="moveMails(f.onServer)"><a href="">{{f.name}}</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div> -->

      <div class="row text-center" style="min-height:50vh;" ng-if="emails.length == 0 && !emptyFolder">
        <div style="margin-left: 220px;margin-top:200px;" class="loader"></div>
      </div>

      <div class="row text-center" style="min-height:50vh;padding-top:200px;" ng-if="emptyFolder">
        <span style="margin-top:200px;">Empty folder</span>
      </div>

      <div ng-repeat="email in emails track by $index" >
        <email-strip data = "email" index="{{$index}}" goto-Mail="gotoMail" flag-Mail= "flagMail" viewing="viewerMail==$index"></email-strip>
      </div>
      <li class="container-fluid" >
        <div class="row">
          <nav>
            <ul class="pager">
              <li class="previous" ng-click="prevPage()" style="cursor:pointer;"><a><span aria-hidden="true">&larr;</span> Newer</a></li>
              <li class="next" ng-click="nextPage()" style="cursor:pointer;"><a>Older <span aria-hidden="true">&rarr;</span></a></li>
            </ul>
          </nav>
        </div>
      </li>

  </div>
  <!-- {{viewerMail}} -->
  <div class="col-md-7" style="background:white;padding:15px;min-height:100vh;">
    <div class="container-fluid">
      <div class="row">
        <!-- ng-if="!editor && viewerMail != -1" -->
        <div  class="row" >

          <div class="col-md-1 text-center" style="width: 100px;">
            <img ng-click="reply()" style="margin-left: 10px;margin-right: 10px;height: 40px;" src="/static/images/icons8-reply-arrow-50.png" alt=""> <br> <br>

            Reply

          </div>

          <div class="col-md-1 text-center" style="width: 100px;">
            <img ng-click="reply('all')" style="margin-left: 10px;margin-right: 10px;height: 45px;" src="/static/images/icons8-reply-all-arrow-50.png" alt=""> <br> <br>

            Reply All

          </div>

          <div class="col-md-1 text-center" style="width: 100px;">
            <img ng-click="reply('forward')" style="margin-left: 10px;margin-right: 10px;height: 45px;" src="/static/images/icons8-forward-arrow-50.png" alt=""> <br> <br>

            Forward

          </div>

          <div class="col-md-1 text-center" style="width: 100px;">
            <img ng-click="reply('forward')" style="margin-left: 10px;margin-right: 10px;height: 45px;" src="/static/images/icons8-remove-64.png" alt=""> <br> <br>

            Delete

          </div>

          <div class="col-md-1 text-center" style="width: 115px;">
            <img ng-click="quote()" style="margin-left: 10px;margin-right: 10px;height: 44px;" src="/static/images/icons8-invoice-64.png" alt=""> <br> <br>

            Create Quote

          </div>

          <div class="col-md-2 pull-right text-right" style="padding-top:20px;">

            <img src="/static/images/icons8-chevron-left-96.png" style="height: 33px;margin-right: 24px;" ng-click="prevMail()" alt="">
            <img src="/static/images/icons8-chevron-right-96.png" style="height: 33px;" ng-click="nextMail()" alt="">

          </div>




          <!-- <button type="button"  class="btn btn-default"><i class="fa fa-reply"></i> Reply</button>
          <button type="button" ng-click = "reply('all')" class="btn btn-default"><i class="fa fa-reply-all"></i> Reply all</button>
          <button type="button" ng-click = "reply('forward')" class="btn btn-default"><i class="fa fa-share"></i> Forward</button>
          <button type="button" class="btn btn-default" ng-click="deleteMail()"><i class="fa fa-trash"></i> Delete</button> -->
          <!-- <div class="btn-group" role="group">
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Move to
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li ng-repeat="f in folders" ng-click="moveMails(f.onServer)"><a href="">{{f.name}}</a></li>
            </ul>
          </div> -->
          <!-- <button type="button" class="btn btn-default" ng-click="quote()"> Quote</button> -->
        </div>

        <div ng-if="editor" class="btn-group" role="group" aria-label="...">
          <button type="button" ng-click="sendMail()" class="btn btn-default"><i class="fa fa-paper-plane"></i> Send</button>
          <!-- <button type="button" ng-click="saveMail()" class="btn btn-default"><i class="fa fa-floppy-o"></i> Save</button> -->
          <button type="button" ng-click="resetEditor()" class="btn btn-default"><i class="fa fa-times"></i> Cancel</button>
          <button type="button" ng-click="showExtraControls('cc')" class="btn btn-default"><i class="fa fa-plus"></i> Add CC</button>
          <button type="button" ng-click="showExtraControls('bcc')" class="btn btn-default"><i class="fa fa-plus"></i> Add Bcc</button>
          <button type="button" ng-click="quote()" class="btn btn-default"> Quote</button>
          <button type="button" ng-click="attach()" class="btn btn-default"><i class="fa fa-file"></i> Attach</button>
          <button type="button" ng-click="pickFile()" class="btn btn-primary"> Pick</button>
        </div>

        <span ng-if="editorData.file.size>0">{{editorData.file.name}}</span>

        <input style="display:none;" ng-if="editor" style="display:inline;" type="file" name="fileInput" id="attach" file-model = "editorData.file">



      </div>
      <!-- the html/text mail viewer -->

      <div class="row" ng-if="!editor && viewerMail != -1" style="padding-top:10px;margin-top: 40px;">
        <div class="row" style="{{emailInView.attachments.length == 0 ? 'border-bottom:solid 2px #e4e1e1;':''}}">
          <div class="col-md-12">
            <div class="col-md-2" style="position:relative;">
              <img ng-if="!emailInView.contact" ng-src="{{emailInView.originator | getDP}}" onerror="this.src='/static/images/img_avatar_card.png'" height="60px" width="60px" style="position:relative;left:-10px;top:-5px;"/>
              <img ng-if="emailInView.contact" ng-src="{{emailInView.contact | getCRMDP}}" onerror="this.src='/static/images/img_avatar_card.png'" height="60px" width="60px" style="position:relative;left:-10px;top:-5px;"/>

              <span ng-if="!emailInView.contact" class="label label-danger" ng-click="addToContact(emailInView.sender, 'xxl')" style="position: absolute;right: 22px;top: 0px;cursor:pointer;">+ add</span>
              <span ng-if="emailInView.contact" class="label label-success" style="position: absolute;right: 22px;top: 0px;">Contact</span>
              <span ng-if="emailInView.contact" ng-click="editContact()" class="label label-primary" style="position: absolute;left: 70px;bottom: 4px;"> <i class="fa fa-pencil"></i> </span>
            </div>
            <div class="col-md-10" style="position:relative;top:-13px;">
              <div class="row" >
                <span class="text-muted"> {{emailInView.sender | emailAddress}}</span>
                <span style="float:right">{{emailInView.date | timeAgo}}</span>
              </div>
              <div class="row" >
                <h5 style="font-size:25px;" class="text-muted"><a href=""> </a> {{emailInView.subject}}</h5>
              </div>
              <div class="row" >
                To : <span class="text-muted">{{emailInView.to | emailAddress}}</span>
              </div>

            </div>
          </div>

        </div>
        <div class="row" ng-if="emailInView.attachments.length >0" style="border-bottom:solid 2px #e4e1e1;">
          <div class="container-fluid" style="padding:0px;">
            <span ng-repeat="f in emailInView.attachments" class="col-md-6" style="margin-right:5px;">
              <div class="card bg-white" style="padding:10px;margin:5px;cursor:pointer;position:relative;" ng-click="downloadFile(f.name)">
                <i class="fa {{f.name | fileTypeIcon}} fa-lg" ></i> <span style="margin-bottom:10px;position:relative;bottom:1px;left:10px;">{{f.name}}</span>
              </div>
            </span>
          </div>
        </div>

        <div ng-if="mailBodyLoading" class="row">
          <div style="margin-left:400px;margin-top:200px;" class="loader"></div>
        </div>
        <div class="row">
          <div class="container-fluid bg-white" style="width:100%;">
            <div ng-bind-html="emailInView.body" ng-if="emailInView.bodyFormat != 'plain'" style="padding-top:5px;font-size: 18px;"></div>
            <div ng-if="emailInView.bodyFormat == 'plain'" style="padding-top:5px;font-size: 18px;">{{emailInView.plainBody}}</div>
          </div>
        </div>
      </div>
      <!-- mail composer -->
      <div class="row" style="padding:10px;" ng-if="editor">
        <div class="container-fluid">
          <div class= "form-group">
            <label class="control-label col-sm-2" for="subject">Subject :</label>
            <div class="col-md-10">
              <input type="text" class = "form-control" name = "subject" placeholder="Subject" ng-model = "editorData.subject">
            </div>
          </div>
          <div class= "form-group">
            <label class="control-label col-sm-2" for="to">To :</label>
            <div class="col-md-10">
              <input type="text" class = "form-control" name = "to" placeholder="To" ng-model = "editorData.to">
            </div>
          </div>
          <div class= "form-group" ng-if="showCC" >
            <label class="control-label col-sm-2" for="cc">CC :</label>
            <div class="col-md-10">
              <input type="text"  class = "form-control" name = "cc" placeholder="CC" ng-model = "editorData.cc">
            </div>
          </div>
          <div class= "form-group" ng-if="showBCC">
            <label class="control-label col-sm-2" for="bcc">BCC :</label>
            <div class="col-md-10">
              <input type="text" class = "form-control" name = "bcc" placeholder="bcc" ng-model = "editorData.bcc">
            </div>
          </div>
          <div class= "form-group" ng-if="editorData.attachments.length >0">
            <label class="control-label col-sm-2" for="bcc">Attachments :</label>
            <div class="col-md-10">
              <span ng-repeat="f in editorData.attachments" class="label label-primary" style="margin-right:5px;"> {{f.filename}}  <i class="fa fa-times" style="margin-left:30px;" ng-click="editorData.attachments.splice($index , 1)"></i> </span>
            </div>
          </div>
        </div>
        <div class="row" style="padding:10px;">
          <textarea ui-tinymce="tinymceOptions" ng-model="editorData.body" ng-if="editorData.bodyFormat!='plain'" ></textarea>
          <textarea ui-tinymce="tinymceOptions" ng-model="editorData.plainBody" ng-if="editorData.bodyFormat=='plain'" ></textarea>
        </div>
        <div class="row" style="margin-top:10px;">
          <div ng-repeat="f in editorData.added" class="col-md-6">
            <div class="container-fluid bg-blue" style="padding-right:0px;padding-top:5px;">
              <i class="fa {{f.filename | fileTypeIcon}} fa-lg" style="margin-right:15px;"></i> {{f.filename}}
              <button type="button" ng-click="removeMailAttachment($index)" class="btn btn-primary btn-sm pull-right">
                <i class="fa fa-minus"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
