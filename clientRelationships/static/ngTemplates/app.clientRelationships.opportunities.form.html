<div>

  <div class="container-fluid" style="margin-bottom:80px;">
    <div class="col-md-9 ">
      <h3 ng-if="mode == 'edit'">Edit opportunity : <strong>{{deal.name}}</strong></h3>
      <h3 ng-if="mode == 'new'">Create a new opportunity</h3>
      <div class="row">
        <div class="container-fluid">
          <button type="button" ng-click="openContactForm()" class="btn btn-primary pull-right">
            Create an contact entry
          </button>
        </div>
      </div>
      <div class="row" style="margin-top:20px;">
        <div class="col-md-6">
          <div class="form-group">
            <label>Name</label>
            <input type="text" class="form-control" ng-model="dealEditor.name">
            <p class="help-block">Enter a nice name for this deal.</p>
          </div>
        </div>
        <div class="col-md-6">
          <company-Field data="dealEditor.company"></company-Field>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6">
          <clients-Field data="dealEditor.otherCRMUsers" url="/api/clientRelationships/contactLite/" col="6" label="Stakeholders at customer side" company="dealEditor.company.pk"></clients-Field>
        </div>
        <div class="col-md-6">
          <users-Field data="dealEditor.internalUsers" url="/api/HR/userSearch/" col="6" label="Internal stakeholders"></users-Field>
        </div>
      </div>


      <div class="form-group">
        <label>Initial State</label>
        <wizard steps="data.steps" editable="true" active="dealEditor.state" error="false"></wizard>
      </div>
      <div class="row">
        <div class="col-md-5">
          <div class="form-group">
            <label>Tentative closing date </label>
            <div class="input-group">
              <input type="text" class="form-control" show-weeks="false" uib-datepicker-popup="dd-MMMM-yyyy" ng-model="dealEditor.closeDate" is-open="status.opened" />
              <span class="input-group-btn">
                <button type="button" class="btn btn-default" ng-click="status.opened = true;"><i class="glyphicon glyphicon-calendar"></i></button>
              </span>
            </div>
          </div>
        </div>
        <div class="col-md-5">
          <div class="form-group">
            <label>Suspected value</label>
            <div class="input-group">
              <div class="input-group-btn">
                <div class="btn-group">
                  <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">
                    <span data-bind="label">{{dealEditor.currency}} {{dealEditor.currency!= null && dealEditor.currency!= '' ? '': 'Currency'}}</span> <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu">
                    <li ng-click="setCurrency('INR')"><a href="">INR</a></li>
                    <li ng-click="setCurrency('USD')"><a href="">USD</a></li>
                  </ul>
                </div>
              </div>
              <input type="search" ng-model="dealEditor.value" class="form-control" />
            </div>
          </div>
        </div>
        <div class="col-md-2">
          <div class="form-group">
            <label>Delivery Time </label>
            <div class="input-group">
              <input type="number" class="form-control" ng-model="dealEditor.deliveryTime">
            </div>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label>Confidence (in %)</label>
        <rzslider rz-slider-model="dealEditor.probability" rz-slider-options="{floor: 0, ceil: 100}"></rzslider>
      </div>
      <div class="form-group">
        <label>Other details (like tech stack , project aim etc )</label>
        <textarea class="form-control" rows="4" ng-model="dealEditor.requirements"></textarea>
      </div>

      <div class="row">
        <div class="col-md-2">
          <button type="button" class="btn btn-default" ng-click="resetDealEditor()">
            Reset
          </button>
        </div>
        <div class="col-md-5">
          <div class="container-fluid card" style="display:none;">
            <div class="col-md-2">
              <br>
              <i class="fa fa-file-pdf-o fa-2x"></i>
            </div>
            <div class="col-md-5">
              <label>Total</label> <br>
              <i class="fa fa-inr"></i> 24,000
            </div>
            <div class="col-md-5">
              <label>Total Items</label> <br>
              <i class="fa fa-inr"></i> 24,000
            </div>
          </div>
        </div>
        <div class="col-md-5">
          <div class="btn-group pull-right">
            <button type="button" class="btn btn-primary" ng-click="saveDeal()">
              Save
            </button>
            <!-- <button type="button" class="btn btn-default" ng-click="quote()">
              Quote
            </button> -->
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-5" style="margin-top:130px;" ng-if="mode=='edit'">
      <div class="row">
        <table class="table">
          <thead>
            <tr style="border:1px solid #337ab7;color:#337ab7" >
              <th >Title</th>
              <th >Description</th>
              <th class="text-center"> Option </th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="a in requiementsData" ng-click="editReq($index)"  style="padding-top:15px;">
              <td>{{a.title}}</td>
              <td>{{a.details}}</td>
              <td class="text-center" ><i class="fa fa-trash" mwl-confirm title="Confirm" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="deleteReq($index,a.pk)" confirm-button-type="danger" cancel-button-type="default" ng-click="$event.stopPropagation()"></i></td>
            </tr>
            <tr style="padding-top:15px;">
              <td style="padding:0px"><input type="text" class="form-control" ng-model="requirement.title" placeholder="Title"></td>
              <td style="padding:0px"><input type="text" class="form-control" ng-model="requirement.details" placeholder="Details"></td>
              <td style="padding:0px">
                <button type="button" class="btn btn-primary" ng-click="addReq()" style="width:100%">
                  Add
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="row">
        <table class="table">
          <thead>
            <tr style="border:1px solid #337ab7;color:#337ab7" >
              <th >Offset</th>
              <th >Percentage</th>
              <th >Mile Stone</th>
              <th class="text-center"> Option</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="b in paymentsData" ng-click="editPayment($index)"  style="padding-top:15px;">
              <td>{{b.offset}}</td>
              <td>{{b.percent}} %</td>
              <td>{{b.milestone}}</td>
              <td class="text-center"><i class="fa fa-trash" mwl-confirm title="Confirm" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="deletePayment($index,b.pk)" confirm-button-type="danger" cancel-button-type="default" ng-click="$event.stopPropagation()"></i></td>
            </tr>
            <tr style="padding-top:15px;">
              <td style="padding:0px"><input type="text" class="form-control" ng-model="payment.offset" placeholder="Offset"></td>
              <td style="padding:0px"><input type="number" class="form-control" ng-model="payment.percent" placeholder="Percent"></td>
              <td style="padding:0px"><input type="text" class="form-control" ng-model="payment.milestone" placeholder="Mile Stone"></td>
              <td style="padding:0px">
                <button type="button" class="btn btn-primary" ng-click="addPaymentData()" style="width:100%">
                  Add
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>

  </div>
</div>
